"use client";

import React from "react";
import Link from "next/link";
import { usePathname } from "next/navigation";
import { motion, useAnimation } from "motion/react";

import Wrapper from "@/components/wrapper";
import { cn, isActivePath } from "@/lib/utils";
import { Separator } from "@/components/ui/separator";

export const Header = () => {
  const pathname = usePathname();
  const controls = useAnimation();
  const [mounted, setMounted] = React.useState(false);

  const disabled = pathname !== "/";

  React.useEffect(() => {
    setMounted(true);
    if (disabled) return;

    const onScroll = () => {
      const y = window.scrollY;

      if (y > 100) {
        controls.start({ y: -80, opacity: 0 });
      } else {
        controls.start({ y: 0, opacity: 1 });
      }
    };

    window.addEventListener("scroll", onScroll);
    return () => window.removeEventListener("scroll", onScroll);
  }, [controls, disabled]);

  return (
    <motion.header
      animate={mounted && !disabled ? controls : undefined}
      initial={{ y: 0, opacity: 1 }}
      transition={{ duration: 0.25 }}
      className="fixed top-6 left-0 z-50 w-full"
    >
      <Wrapper>
        <nav className="mx-auto flex h-14 w-full max-w-[369px] items-center justify-center rounded-full bg-black/70 px-7 py-2 backdrop-blur-xs sm:h-[60px]">
          <div className="flex h-5 items-center justify-between">
            <Link href="/">
              <svg
                viewBox="0 0 65 19"
                className={cn(
                  "fill-background hover:fill-primary h-4 w-14 min-[390px]:h-5 min-[390px]:w-16",
                  {
                    "fill-primary": isActivePath("/", pathname),
                  },
                )}
              >
                <path d="M12.6541 8.71489L10.2154 8.67324C10.2154 8.95853 10.0954 15.6015 10.2154 17.0362L12.6455 16.8405C12.5555 15.7451 12.6198 10.6036 12.6541 8.71489ZM11.3683 4.55005C11.0573 4.55218 10.7525 4.6347 10.4851 4.78913C10.2177 4.94356 9.99742 5.16435 9.84684 5.42883C9.67008 5.72351 9.57445 6.05749 9.5692 6.39854C9.56394 6.73959 9.64924 7.0762 9.81684 7.37589C9.97281 7.63424 10.1967 7.84758 10.4657 7.99397C10.7346 8.14037 11.0387 8.21454 11.3469 8.20886C11.5978 8.21728 11.8479 8.17636 12.0821 8.08856C12.3164 8.00077 12.53 7.8679 12.7101 7.69794C12.8902 7.52797 13.0331 7.32441 13.1303 7.09946C13.2275 6.8745 13.2769 6.63279 13.2756 6.38883C13.2747 6.1472 13.2248 5.90811 13.1286 5.68529C13.0324 5.46247 12.8918 5.26031 12.715 5.09042C12.5382 4.92054 12.3286 4.78626 12.0982 4.69532C11.8679 4.60437 11.6213 4.55854 11.3726 4.56046L11.3683 4.55005Z" />
                <path d="M26.7183 4.31899C26.5769 6.31395 26.3583 9.81866 26.4419 11.191C26.5726 13.288 26.429 17.0218 26.4226 17.1717L23.9882 17.0821C23.9882 17.0447 24.1339 13.315 24.0096 11.3326C23.9218 9.89363 24.1211 6.55343 24.2646 4.4606C23.1739 4.53557 22.0788 4.61678 21.0202 4.70424L20.8059 2.34486C20.8381 2.34486 24.0611 2.07623 27.4491 1.89922C34.5444 1.52855 35.4466 1.88464 35.8794 2.05748L34.9601 4.25027C34.2658 4.02121 30.7556 4.09409 26.7183 4.31899Z" />
                <path d="M45.3212 16.803H42.8847C42.8847 16.0679 41.046 13.9189 38.7681 11.9218L38.7445 17.0404H36.308L36.3401 9.92895L36.3787 1.66799L37.4159 1.52014C41.2196 0.978708 42.4775 1.52013 43.2726 2.17818C44.0676 2.83622 44.4448 3.81496 44.4555 5.17895C44.4748 7.70492 42.3125 9.51246 40.7353 10.4954C41.1896 10.9119 41.7147 11.395 42.2354 11.9281C45.0019 14.681 45.3212 16.0284 45.3212 16.803ZM42.0189 5.1727C42.0189 4.54797 41.9011 4.13149 41.6846 3.9524C41.3096 3.63796 40.341 3.55883 38.8067 3.71293L38.7831 8.85234C40.0539 8.1818 42.0318 6.79491 42.0189 5.1727Z" />
                <path d="M56.1861 8.09231C56.1861 8.81907 56.1368 9.96649 56.0875 11.0639C56.0382 12.1614 55.9932 13.2588 55.9932 13.9356C55.9932 14.2813 55.9182 15.16 55.7961 16.5657C55.7125 17.5298 55.6075 18.7272 55.6075 18.9979H53.1709C53.1709 18.6523 53.2459 17.7735 53.3681 16.3678C53.4517 15.4037 53.5567 14.2063 53.5567 13.9356C53.5567 13.2088 53.606 12.0614 53.6531 10.964C53.7003 9.86653 53.7495 8.7691 53.7495 8.09439C53.7495 7.65292 53.6938 6.85535 53.6274 6.03904C53.4731 6.44095 53.3467 6.7908 53.2802 7.01153C52.8666 8.39634 52.0502 12.8069 52.0416 12.8423C51.9918 13.1155 51.8448 13.3631 51.6262 13.5416C51.4076 13.7202 51.1314 13.8183 50.8458 13.819C50.561 13.8187 50.2852 13.7215 50.0664 13.5442C49.8475 13.3669 49.6995 13.1208 49.6479 12.8486C49.6479 12.7965 48.6665 7.68624 48.1886 6.0682C48.1543 5.95158 48.0964 5.7829 48.0257 5.58507C48.0257 5.64755 48.015 5.70377 48.0107 5.75167C47.9079 7.18646 47.925 10.1039 48.0107 11.4887C48.0471 12.0531 48.18 12.9027 48.3193 13.8023C48.5122 15.0309 48.7115 16.3012 48.7115 17.1904H46.2706C46.2706 16.4824 46.0778 15.2475 45.9063 14.1584C45.7563 13.2046 45.617 12.303 45.5742 11.6303C45.4842 10.1726 45.4649 7.14689 45.5742 5.59132C45.6213 4.89996 45.8913 2.96331 45.902 2.88418C45.9414 2.60023 46.0854 2.33976 46.3072 2.15101C46.529 1.96225 46.8137 1.858 47.1085 1.85754H48.3279C48.5721 1.85747 48.8108 1.9287 49.0129 2.062C49.2151 2.1953 49.3713 2.38451 49.4615 2.60513C49.5472 2.81337 50.3187 4.68755 50.533 5.41848C50.6273 5.73917 50.7473 6.1744 50.8544 6.66793C50.8866 6.54923 50.9166 6.44095 50.9466 6.34308C51.2359 5.37891 52.2838 2.87168 52.4038 2.59472C52.4653 2.44565 52.5577 2.31048 52.6753 2.19763C52.7929 2.08478 52.9332 1.99666 53.0874 1.93876C53.2416 1.88035 53.4064 1.85301 53.5718 1.85838C53.7372 1.86375 53.8997 1.90172 54.0496 1.96999L55.1403 2.46978C55.3303 2.55649 55.4938 2.68954 55.6151 2.85595C55.7364 3.02236 55.8113 3.21647 55.8325 3.41936C55.8411 3.56305 56.1861 6.83661 56.1861 8.09231Z" />
                <path d="M64.9593 14.0356C64.6807 16.0097 63.1099 17.4341 61.1384 17.4965H60.9091C59.5548 17.4965 58.4854 17.0988 57.7268 16.3158C57.1354 15.7036 56.4732 14.5562 56.6704 12.5529V12.5091L59.1026 12.6487C59.1026 12.6757 59.1026 12.7195 59.0919 12.7778C58.9805 13.8981 59.2526 14.4437 59.4991 14.6936C59.7991 15.0039 60.322 15.1496 61.0548 15.1247C62.0063 15.0955 62.4478 14.375 62.5399 13.7107C62.6621 12.834 62.2185 11.6283 60.5598 11.1264C57.3454 10.1477 56.4689 7.76747 56.7025 6.02865C56.8083 5.06448 57.2646 4.16863 57.9894 3.50215C58.7141 2.83568 59.6597 2.4423 60.6563 2.39274C62.4542 2.29903 63.4164 2.95916 63.905 3.53182C65 4.81251 64.6057 6.55341 64.5586 6.74708L63.3735 6.46804L62.1863 6.1994C62.2442 5.94743 62.2828 5.33312 62.0277 5.04158C61.7727 4.75004 61.1427 4.73963 60.7891 4.75837C60.3639 4.77989 59.961 4.95001 59.6546 5.23739C59.3482 5.52477 59.159 5.91006 59.1219 6.32227C58.974 7.4551 59.7884 8.40469 61.297 8.86699C64.2028 9.75618 65.2293 12.1031 64.9593 14.0356Z" />
                <path d="M20.643 13.442C20.5894 13.6898 20.2273 14.9372 18.4658 15.108C17.7757 15.1704 17.5014 14.9476 17.4136 14.8726C17.0021 14.5332 16.8693 13.8627 16.85 13.6232L16.8178 12.5153C16.7953 11.6362 16.8276 10.7565 16.9143 9.88108H21.108V7.47796H17.2872L17.8186 4.6542L15.3971 4.22314L14.7842 7.47796H13.5563V9.87067H14.4413C14.3593 10.7707 14.3299 11.6745 14.3535 12.5778L14.3856 13.7294C14.3856 13.9189 14.5099 15.6036 15.7892 16.676C16.4692 17.2354 17.3373 17.5319 18.2279 17.509C18.3779 17.509 18.5344 17.509 18.6972 17.4861C21.6652 17.2091 22.8481 15.0142 23.0581 13.8918L20.643 13.442Z" />
                <path d="M8.30178 10.2517C7.55948 9.67535 6.68693 9.27852 5.75595 9.0939C6.98601 8.15265 8.09606 6.83447 8.0832 5.15188C8.0832 3.78789 7.68675 2.80708 6.90029 2.15111C6.70366 1.98812 6.48786 1.84832 6.2574 1.73463V0.318583H4.28803V1.29732C3.92467 1.27948 3.56062 1.27948 3.19727 1.29732V0.00830078H1.2279V1.48265L1.04789 1.50556L0.00427246 1.65341L0.0407022 17.5902L1.13789 17.6922H1.2279V18.9979H3.19727V17.6839C3.31727 17.6839 3.43942 17.6672 3.56371 17.6547C3.8123 17.6297 4.05445 17.5964 4.28803 17.5589V18.6793H6.2574V17.0321C6.8617 16.7994 7.42162 16.47 7.91391 16.0575C8.39514 15.6422 8.78104 15.1332 9.0465 14.5634C9.31196 13.9937 9.45103 13.376 9.45469 12.7506C9.4719 12.2762 9.37693 11.8042 9.17707 11.371C8.9772 10.9378 8.67776 10.5549 8.30178 10.2517ZM5.31236 3.94824C5.52666 4.12941 5.64238 4.53965 5.64666 5.16854C5.64666 6.29096 4.25589 7.2926 3.42014 7.7903C3.09227 7.98605 2.76225 8.15889 2.45152 8.30883L2.44081 3.70876C3.97302 3.55883 4.93735 3.63796 5.31236 3.9524V3.94824ZM6.29812 14.277C5.36379 15.0829 3.67729 15.3183 2.46867 15.3495L2.45795 11.1846C4.07588 11.1159 5.93596 11.3929 6.70528 12.0468C6.80756 12.1196 6.88967 12.2159 6.94426 12.3271C6.99886 12.4383 7.02425 12.5609 7.01815 12.684C7.02523 12.9851 6.96444 13.2841 6.84006 13.56C6.71568 13.836 6.53071 14.0821 6.29812 14.2812V14.277Z" />
                <path d="M32.7293 13.7607C32.3585 14.6228 31.8999 14.6499 31.7242 14.6624C31.1842 14.6978 31.0042 14.5395 30.9442 14.4854C30.5906 14.173 30.4449 13.3879 30.3827 12.7007C30.5735 12.632 30.7899 12.5508 31.0256 12.4529C31.8811 12.1017 32.7059 11.6838 33.4922 11.2035C34.8636 10.3393 35.4744 9.5771 35.4744 8.73372C35.4744 7.06778 34.8636 5.74336 33.8007 5.11864C33.2907 4.82085 32.2214 4.43144 30.7642 5.17278C28.6962 6.2244 27.8326 9.25849 27.8991 11.799C27.9376 13.5004 28.1369 15.2121 29.3005 16.2471C29.9255 16.7835 30.7388 17.0661 31.5721 17.0363C31.6792 17.0363 31.7864 17.0363 31.8892 17.0259C33.2907 16.9343 34.3986 16.0763 35.0094 14.6061C35.2626 13.9839 35.4186 13.3283 35.4723 12.6612L33.04 12.5133C33.0004 12.9417 32.8957 13.3621 32.7293 13.7607ZM31.8935 7.25937C32.0506 7.1753 32.2232 7.12222 32.4014 7.10318C32.4494 7.10151 32.497 7.11306 32.5385 7.1365C32.7271 7.24479 32.995 7.70708 33.0314 8.54213C32.86 8.73164 32.35 9.15437 31.2528 9.72495C30.9678 9.8728 30.6977 9.99983 30.4513 10.1123C30.6849 8.74413 31.2335 7.59464 31.8935 7.25937Z" />
              </svg>
            </Link>

            <Separator
              orientation="vertical"
              className="bg-background/40 mx-4 h-4!"
            />

            <Link
              href="/about"
              className={cn(
                "hover:text-primary text-background font-normal tracking-[-2%]",
                {
                  "text-primary": isActivePath("/about", pathname),
                  "hover:italic": !isActivePath("/about", pathname),
                },
              )}
            >
              <span className="text-xs min-[390px]:text-sm md:text-base">
                About
              </span>
            </Link>

            <Separator
              orientation="vertical"
              className="bg-background/40 mx-4 h-4!"
            />

            <Link
              href="/suggest"
              className={cn(
                "hover:text-primary text-background font-normal tracking-[-2%]",
                {
                  "text-primary": isActivePath("/suggest", pathname),
                  "hover:italic": !isActivePath("/suggest", pathname),
                },
              )}
            >
              <span className="text-xs min-[390px]:text-sm md:text-base">
                Suggest a term
              </span>
            </Link>
          </div>
        </nav>
      </Wrapper>
    </motion.header>
  );
};
